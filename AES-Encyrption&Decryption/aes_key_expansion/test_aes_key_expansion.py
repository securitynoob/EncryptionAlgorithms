#!/usr/bin/env python
# coding: utf-8

# In[7]:


import inspect, sys
from terminaltables import AsciiTable


# In[1]:


def test_g(g):
    input_word = bytearray(b'\xfc\xa2\xb4\xb0')
    output_word = g(input_word, 2)
    expected_output = bytearray(b'8\x8d\xe7\xb0')
    return expected_output == output_word


# In[3]:


def test_expanded_key_128(expand_key_128):
    initial_key = bytearray(b'\x8fM\xcd@)\x9d\x1eto<\xd1\tnc\x9e\x94')
    expanded_key = expand_key_128(initial_key)
    expected_output = bytearray(b'\x8fM\xcd@)\x9d\x1eto<\xd1\tnc\x9e\x94\xf9F\xef\xdf\xd0\xdb\xf1\xab\xbf\xe7 \xa2\xd1\x84\xbe6\xa7\xe8\xea\xe1w3\x1bJ\xc8\xd4;\xe8\x19P\x85\xde\xf6\x7f\xf75\x81L\xec\x7fI\x98\xd7\x97P\xc8RI\x1a\x7f\xccf\x9b3 \x19\xd2\xab\xf7\x8e\x82c\xa5\xc7\xe9y\nurJ*l\xa0\xe1\xdd\xe2"\x82x%\xea\xc55\xe6\x98\x8f\x1f\x8a8n\xc2h\x1a\xec\xbaM\x041\xd6D\x9c\xbe\xc9\xce\xa4\xd0\x0b\xa6\xbe<\xb1\xeb\xaf\xf9?\xea3G\xf6$\x97\x97\xfd\x82)\xabLiM\xd0\xc6O~\x970k\xe9\x00\xcd\xe9\xc0\xab\x81\x804\xdc\x0b\xf5JK;\x9e\xa3K\xf6wc\xe0w\xf7')
    return expected_output == expanded_key


# In[4]:


def test_expanded_key_192(expand_key_192):
    expected_output = bytearray(b'\xa5\x1e\n\xaawHK\xd6\xf6V\xef\xb2\x0f\n\xaf\x94\x0f\xd6\x17W\x13\xaa\x01s\x84b\x85\xd7\xf3*\xce\x01\x05|!\xb3\nv\x8e\'\x05\xa0\x99p\x16\n\x98\x03\xe2$\xfe\x90\x11\x0e0\x91\x14r\x11"\x1e\x04\x9f\x05\x1b\xa4\x06u\r\xae\x9ev\x04/\xc6G\x15!\xf6\xd6\x01S\xe7\xf4\x1fWx\xf1\x04\xf3~\x84\t]\xe0\xf2L\xceOFY\xef\xb9\x90X\xbc^dG\xeb&\x95C\x18X\x11JE\xb8\xe3*\xa2^\x90sM\xe7\x00+\xf1\xb9dl\x1a\x9f\xf1/\x02\xc7\xe0eG\x7f\x03\x9ap%\xdd\xe9=\xc2\xdd\xc2\xcc{\xb9\xae\xd6\xe4H\x81\xd4#\xa8\xe4\x93\\\xabf:G\xb4\x8f\x07\x85iM\xcb\xfe\xd0\xe3\x1d\x1a\x98b\xc990\x86Ze\x9b\x98wS\xf0\x17p\xd6\x99Z\xbb(I\xb9\xa62\xd1')
    initial_key = bytearray(b'\xa5\x1e\n\xaawHK\xd6\xf6V\xef\xb2\x0f\n\xaf\x94\x0f\xd6\x17W\x13\xaa\x01s')
    expanded_key = expand_key_192(initial_key)
    return expected_output == expanded_key


# In[5]:


def test_expanded_key_256(expand_key_256):
    expected_output = bytearray(b'$l\xc7L\x905\xbb\xfb\xa3\xffz\xbbyH\xa0\x91\xa6\xbb\xc1)\xe5\x019G\x90\x9e\xddy\xba\x18-\xe5\x93\r\xf2\xf3L\xe22\xf6\x8agY\xf9\x07\xcdk\x08c\x06\xbe\x19\x1en\x97\x93\xe2\x01U\xa5"d\xd1\xe3\xbf\xbfp/D\xeac\xe3\x91\xe0\xa2\xe8\x86,Q\x93\'wo\xc5\xd2\x9b?5W\x15 3y=f \x80|\xd9a\x89\xfaV\x0c6\xcd\x13\x16\x83\x91,\xd4\xcb\xf6\x1e\x8d\xcd\xd9Mh\xea \xc3v\xfe\x8aH\x18Z|L\x8b7\xea\x7f1\xacJ\xc1\xd1\x12GT\xea\x02V>\n\xbah\xff\x0f\x1ee\xd5\x00\x8c\xc7K{\xd1\x11\xb1\xc8\th\xb7\xd9\xad\x0fh\xe4\x871\x11\x83\x15\x91\xbc\xe6\xe3\xe9\x9a\x81\x0f{m\x0c\xfa\xe6w\x85\xda\xf79\x10^\x00\xa5\x13\xf5ln\x99aa\x8em\xfa~\xa5\xda\xce\x1a\x9c\xd6\x84\xd9\xb3\xfa\xa5\xd3\x1a\xa8\x80\xcd\x1c\x7f\x93\xbd9\xc1)\x16|\xe1\xc4&\x9e\x95')
    initial_key = bytearray(b'$l\xc7L\x905\xbb\xfb\xa3\xffz\xbbyH\xa0\x91\xa6\xbb\xc1)\xe5\x019G\x90\x9e\xddy\xba\x18-\xe5')
    expanded_key = expand_key_256(initial_key)
    return  expected_output == expanded_key


# In[6]:


def get_module_functions(module):
    ret = {}
    for name,obj in inspect.getmembers(module):
        if (inspect.isfunction(obj) and not name.startswith('test')):
            ret[name] = obj
    return ret
